<h1>バスケット</h1>

<% if @cart_items.present? %>

  <%= link_to "カートを空にする",cart_item_path, method: :destroy, "data-confirm" => "本当に消しますか?" %>

  <table>

    <tr>

      <th>商品名</th>

      <th>単価(税込)</th>

      <th>数量</th>

      <th>小計</th>

      <th></th>

    </tr>

    <% @cart_item.each do |i| %>

    <tr>

      <th><%= i.item.name %></th>

      <th><%= i.item.tax_price.to_s(:delimited, delimiter: ',') %></th>

      <th>

        <%= form_with model: i, url: cart_item_path(i), method: :patch do |f| %>

        <%= f.number_filed :amount, size: 10, min: 1 %>

        <%= f.submit "変更" %>

        <% end %>

      </th>

      <th><%= subtotal(i).to_s(:delimited, delimiter: ',') %></th>

      <th>

        <%= link_to "削除する", cart_item_path(i), method: :delete, "data-confirm" => "本当に消しますか?" %>

      </th>

    </tr>

    <% end %>

  </table>

  <%= link_to "買い物を続ける", root_path %>

  <table>

  <tr>

    <td>合計金額</td>

    <td>￥<%= total_price(@cart_items).to_s(:delimited, delimiter: ',') %></td>

  </tr>

  </table>

   <%= link_to " 情報入力に進む", new_order_path, class: "btn btn-success center-block" %>

<% else %>

    <%= render "no_cart" %>

<% end %>